<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<style>
body{font-family:Arial;background:#111;color:#fff;padding:20px}
table{width:100%;border-collapse:collapse;margin-top:20px}
td,th{border:1px solid #333;padding:8px;text-align:center}
input{width:80px}
button{padding:4px 10px;cursor:pointer}
#status{margin-top:10px;color:#f00}
</style>
</head>
<body>

<h2>Admin Panel</h2>

<label>Admin Token:</label>
<input id="token" placeholder="ADMIN_TOKEN">
<button onclick="loadUsers()">–ö—ñ—Ä—É</button>
<div id="status"></div>

<table>
<thead>
<tr>
<th>Telegram ID</th>
<th>–ë–∞–ª–∞–Ω—Å</th>
<th>–ñ–∞“£–∞ –±–∞–ª–∞–Ω—Å</th>
<th>–°–∞“õ—Ç–∞—É</th>
</tr>
</thead>
<tbody id="users"></tbody>
</table>

<script>
const API = "https://azionline.onrender.com"; // üü¢ Render –Ω–∞“õ—Ç—ã URL “õ–æ–π

async function loadUsers(){
  const token = document.getElementById("token").value.trim();
  document.getElementById("status").textContent = "üîÑ –ñ“Ø–∫—Ç–µ–ª—É–¥–µ...";

  try {
    const res = await fetch(API+"/api/admin/users",{
      headers:{ "Authorization": token }
    });

    if(!res.ok){
      document.getElementById("status").textContent = "‚ùå “ö–∞—Ç–µ token –Ω–µ–º–µ—Å–µ —Å–µ—Ä–≤–µ—Ä–≥–µ “õ–æ—Å—ã–ª–∞ –∞–ª–º–∞–¥—ã";
      return;
    }

    const users = await res.json();
    const tbody = document.getElementById("users");
    tbody.innerHTML="";

    users.forEach(u=>{
      tbody.innerHTML += `
        <tr>
          <td>${u.telegramId}</td>
          <td>${u.balance}</td>
          <td><input id="b_${u.telegramId}" value="${u.balance}"></td>
          <td><button onclick="save('${u.telegramId}')">üíæ</button></td>
        </tr>
      `;
    });

    document.getElementById("status").textContent = "‚úÖ “ö–æ–ª–¥–∞–Ω—É—à—ã–ª–∞—Ä –∂“Ø–∫—Ç–µ–ª–¥—ñ";

  } catch(e){
    console.log(e);
    document.getElementById("status").textContent = "‚ùå –°–µ—Ä–≤–µ—Ä–≥–µ “õ–æ—Å—ã–ª–∞ –∞–ª–º–∞–¥—ã";
  }
}

async function save(id){
  const token = document.getElementById("token").value.trim();
  const balance = document.getElementById("b_"+id).value;

  try{
    await fetch(API+"/api/admin/balance",{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        "Authorization": token
      },
      body:JSON.stringify({
        telegramId:id,
        balance:Number(balance)
      })
    });
    alert("–°–∞“õ—Ç–∞–ª–¥—ã");
  }catch(e){
    alert("‚ùå “ö–∞—Ç–µ —Å–∞“õ—Ç–∞—É");
  }
}
</script>

</body>
</html>
